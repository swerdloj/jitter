// Goal: Make this work
use libtest::PubStruct;

// Works
struct JitterStruct {
    a: u32,
    pub b: i32,
}

// Works
extern {
    fn print_i32(n: i32);
    fn print_u32(n: u32);
    fn hello_from_rust(n: u32);
}

// Works
fn FFI(a: u32) {
    hello_from_rust(a);
}

fn imports() {
    let imported: PubStruct;
}

// Works
fn test() -> i32 {
    let x = -2_i32;
    // x = -4_i32;

    x
}

// Works
fn params(a: u32, b: u32) -> u32 {
    b
}

// Works
fn structs(a: u32, b: i32) -> i32 {
    let x = JitterStruct {
        a,
        b,
    };

    x.b = 7_i32;

    x.b
}

// Works
fn struct_return(a: u32, b: i32) -> JitterStruct {
    print_u32(a);
    print_i32(b);

    JitterStruct {
        a,
        b,
    }
}

// Works
fn function_call1() -> i32 {
    test()
}

// Works
fn ret_u32() -> u32 {
    77_u32
}

// Works, but requires hack (move the nested function return value into local stack slot)
fn function_call2() -> JitterStruct {
    struct_return(ret_u32(), test())
}